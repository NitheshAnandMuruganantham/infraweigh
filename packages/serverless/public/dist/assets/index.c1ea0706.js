import{r as f,bn as z,N as G,l,n as e,W as y,K as C,aI as w,bb as L,bo as T,be as v,aK as E,bp as M,bq as O,br as P}from"./index.4c95a279.js";import{b as W,e as R,F as S,c as k,k as B,f as o,T as c,D as N,G as j}from"./index.3fb97640.js";import{c as q,a,M as D}from"./index.a03a43f2.js";import{c as K}from"./Lazy.211a25ac.js";import{A as Q}from"./index.b83c20b3.js";import{B as u}from"./TextField.a171345c.js";import{L as A}from"./LinearProgress.8dbc60f0.js";import{c as V}from"./index.ac0a1a76.js";function $(){const[d,m]=f.exports.useState(!1),[g,{loading:b}]=z(),h=()=>{m(!0)},p=()=>{m(!1)},[i]=G();return l("div",{children:[e(u,{variant:"outlined",sx:{m:1},onClick:h,children:"new WeighBridge"}),l(W,{fullWidth:!0,open:d,onClose:p,children:[e(R,{children:"New WeighBridge"}),e(S,{initialValues:{name:"",address:"",display_name:"",tenant:{label:"",value:null},pin_code:"",phone:"",mail:""},validationSchema:()=>q().shape({name:a().required("Required"),address:a().required("Required"),tenant:K(()=>i!=="admin"?q().notRequired():q().shape({label:a().required("Required"),value:a().required("Required")}).required("Required")),display_name:a().required("Required"),pin_code:a().required("Required"),phone:a().required("Required"),mail:a().required("Required")}),onSubmit:async(n,{setSubmitting:s})=>{s(!0);let t={};i!=="admin"?t={address:n.address,display_name:n.display_name,pin_code:n.pin_code,name:n.name,phone:n.phone,mail:n.mail}:t={tenent_id:n.tenant.value,address:n.address,display_name:n.display_name,pin_code:n.pin_code,name:n.name,phone:n.phone,mail:n.mail},await g({variables:{object:t}}).catch(r=>{y.error("can not add new WeighBridge")}).then(r=>r&&y.success("WeighBridge added successfully")),s(!0),p()},children:({submitForm:n,isSubmitting:s,setFieldValue:t})=>l(C,{children:[e(k,{children:e(B,{children:l(w,{sx:{display:"flex",flexDirection:"column"},children:[e(o,{component:c,sx:{my:1},name:"name",type:"text",label:"name"}),e(o,{component:c,type:"text",label:"address",name:"address",sx:{my:1}}),e(o,{component:c,type:"text",label:"pin code",name:"pin_code",sx:{my:1}}),e(o,{component:c,sx:{my:1},name:"display_name",type:"text",label:"display name"}),e(o,{component:c,sx:{my:1},name:"mail",type:"email",label:"mail"}),e(D,{label:"phone",variant:"outlined",sx:{my:1},defaultCountry:"in",onChange:r=>t("phone",r.toString())}),i==="admin"&&i!==null&&e(Q,{sx:{width:"100%"},name:"tenant",label:"tenant",serverName:"tenents",queryHook:L}),(s||b)&&e(A,{})]})})}),l(N,{children:[e(u,{onClick:p,children:"Cancel"}),e(u,{onClick:n,children:"Add"})]})]})})]})]})}const H=({id:d})=>{const[m,g]=f.exports.useState(!1),[b,{loading:h}]=T(),[p,{data:i,loading:n}]=v({variables:{where:{id:{_eq:d}}}}),s=async()=>{await p(),g(!0)},t=()=>{g(!1)};return l("div",{children:[e(u,{variant:"contained",color:"secondary",size:"small",onClick:s,children:"Edit"}),l(W,{fullWidth:!0,open:m,onClose:t,children:[e(R,{children:"Edit WeighBridge"}),e(S,{initialValues:{name:(i==null?void 0:i.weighbridge[0].name)||"",address:(i==null?void 0:i.weighbridge[0].address)||"",display_name:(i==null?void 0:i.weighbridge[0].display_name)||"",pin_code:(i==null?void 0:i.weighbridge[0].pin_code)||"",phone:(i==null?void 0:i.weighbridge[0].phone)||"",mail:(i==null?void 0:i.weighbridge[0].mail)||""},validationSchema:()=>q().shape({name:a().required("Required"),address:a().required("Required"),display_name:a().required("Required"),pin_code:a().required("Required"),phone:a().required("Required"),mail:a().required("Required")}),onSubmit:async(r,{setSubmitting:x})=>{x(!0),b({variables:{pkColumns:{id:d},_set:{address:r.address,display_name:r.display_name,pin_code:r.pin_code,name:r.name,phone:r.phone,mail:r.mail}}}).catch(()=>y.error("Something went wrong")).then(_=>_&&y.success("WeighBridge updated successfully")),x(!0),t()},children:({submitForm:r,isSubmitting:x,setFieldValue:_})=>l(C,{children:[e(k,{children:e(B,{children:l(w,{sx:{display:"flex",flexDirection:"column"},children:[e(o,{component:c,sx:{my:1},name:"name",type:"text",label:"name"}),e(o,{component:c,type:"text",label:"address",name:"address",sx:{my:1}}),e(o,{component:c,type:"text",label:"pin code",name:"pin_code",sx:{my:1}}),e(o,{component:c,sx:{my:1},name:"display_name",type:"text",label:"display name"}),e(o,{component:c,sx:{my:1},name:"mail",type:"email",label:"mail"}),e(D,{label:"phone",value:i==null?void 0:i.weighbridge[0].phone,variant:"outlined",sx:{my:1},defaultCountry:"in",onChange:F=>_("phone",F.toString())}),(x||h||n)&&e(A,{})]})})}),l(N,{children:[e(u,{onClick:t,children:"Cancel"}),e(u,{onClick:r,children:"confirm"})]})]})})]})]})},I=[{field:"name",headerName:"name",width:150},{field:"address",headerName:"Address",width:300},{field:"display_name",headerName:"display name",width:300},{field:"phone",headerName:"phone",width:150},{field:"mail",headerName:"mail",width:180},{field:"edit",headerName:"Edit",width:75,sortable:!1,filterable:!1,renderCell:d=>e(H,{id:d.row.id})},{field:"delete",headerName:"Delete",width:75,sortable:!1,filterable:!1,renderCell:d=>e(u,{variant:"contained",color:"error",size:"small",onClick:()=>{V({title:"Confirm to Delete",message:"Are you sure want to delete this.",buttons:[{label:"Yes",onClick:async()=>{E.mutate({mutation:M,variables:{where:{id:{_eq:d.row.id}}}}).catch(()=>{y.error("relation exists so remove the related resources to delete this resource !")}).then(m=>{m&&y.success("WeighBridge deleted successfully")})}},{label:"No",onClick:()=>null}]})},children:"Delete"})}],re=()=>{var r;const[d,m]=f.exports.useState([]),[g,b]=f.exports.useState(1),[h,p]=f.exports.useState(10),{data:i,loading:n}=O({variables:{limit:h,offset:(g-1)*h,orderBy:d}}),{data:s,loading:t}=P({variables:{orderBy:d}});return l(w,{children:[e($,{}),e(w,{height:500,width:"100%",textAlign:"center",children:e(j,{loading:n||t,data:(i==null?void 0:i.weighbridge)||[],pageSize:h,setFilter:()=>null,setPage:b,setPageSize:p,setSort:m,rowCount:((r=s==null?void 0:s.weighbridge_aggregate.aggregate)==null?void 0:r.count)||0,columns:I})})]})};export{re as default};

import{r as b,bi as O,l as i,K as v,n as e,aK as P,bj as j,aI as g,bk as M,bl as W,bm as I}from"./index.4c95a279.js";import{b as _,e as S,F as w,c as R,k as T,f as s,T as m,D as z,G as K}from"./index.3fb97640.js";import{c as D,a as o,d as F,M as N}from"./index.a03a43f2.js";import{B as f,e as V,T as Q}from"./TextField.a171345c.js";import{S as A}from"./Switch.fbd48d7b.js";import{L as E}from"./LinearProgress.8dbc60f0.js";import{L as H}from"./index.fd8f2665.js";const J=({id:n})=>{var r,d,p,y,k,C;const[h,u]=b.exports.useState(!1),[c,{data:a}]=O({variables:{tenentsByPkId:n}}),x=async()=>{await c(),u(!0)},t=()=>{u(!1)};return i(v,{children:[e(f,{variant:"contained",color:"secondary",size:"small",onClick:x,children:"Edit"}),i(_,{fullWidth:!0,open:h,onClose:t,children:[e(S,{children:"Edit Request"}),e(w,{initialValues:{name:(r=a==null?void 0:a.tenents_by_pk)==null?void 0:r.name,address:((p=(d=a==null?void 0:a.tenents_by_pk)==null?void 0:d.metadata)==null?void 0:p.address)||"",email:(y=a==null?void 0:a.tenents_by_pk)==null?void 0:y.email,phone:(k=a==null?void 0:a.tenents_by_pk)==null?void 0:k.phone,active:(C=a==null?void 0:a.tenents_by_pk)==null?void 0:C.activate},validationSchema:()=>D().shape({name:o().required("Required"),address:o().required("Required"),email:o().required("Required"),phone:o().required("Required"),active:F().required("required")}),onSubmit:async(l,{setSubmitting:q})=>{q(!0),console.log(n),await P.mutate({mutation:j,variables:{pkColumns:{id:n},set:{name:l.name,email:l.email,phone:l.phone,metadata:{address:l.address},activate:l.active}}}).catch(()=>{alert("realted resourses exists delete those resource to continue")}),q(!0),t()},children:({submitForm:l,isSubmitting:q,setFieldValue:L,setSubmitting:$,values:B})=>i(v,{children:[e(R,{children:e(T,{children:i(g,{sx:{display:"flex",flexDirection:"column"},children:[e(s,{component:m,sx:{my:1},name:"name",type:"text",label:"name"}),e(s,{component:m,type:"email",label:"email",name:"email",sx:{my:1}}),e(s,{component:m,type:"text",label:"address",name:"address",sx:{my:1}}),e(s,{component:A,type:"checkbox",label:"active",name:"active",sx:{my:1}}),e(N,{label:"phone",variant:"outlined",value:B.phone,countryCodeEditable:!1,sx:{my:1},defaultCountry:"in",onChange:G=>L("phone",G.toString())}),q&&e(E,{})]})})}),i(z,{children:[e(f,{onClick:t,children:"Cancel"}),e(f,{onClick:()=>{l().then(()=>{$(!1)})},children:"Add"})]})]})})]})]})},U=()=>{const[n,h]=b.exports.useState(!1),u=()=>{h(!0)},c=()=>{h(!1)},[a,{loading:x}]=M();return i("div",{children:[e(H,{open:x,setOpen:()=>null}),e(f,{variant:"outlined",sx:{m:1},onClick:u,children:"new client"}),i(_,{fullWidth:!0,open:n,onClose:c,children:[e(S,{children:"New Client"}),e(w,{initialValues:{name:"",address:"",email:"",phone:"",razorpay_id:"",activate:!0},validationSchema:()=>D().shape({name:o().required("Required"),razorpay_id:o().required("Required"),address:o().required("Required"),email:o().required("Required"),phone:o().required("Required"),activate:F().required("Required")}),onSubmit:async(t,{setSubmitting:r})=>{r(!0),a({variables:{object:{name:t.name,razorpay_id:t.razorpay_id,email:t.email,phone:t.phone,activate:t.activate,metadata:{address:t.address}}}}).catch(()=>{alert("can not create new client"),r(!1)}),r(!1),c()},children:({submitForm:t,isSubmitting:r,setFieldValue:d})=>i(v,{children:[e(R,{children:e(T,{children:i(g,{sx:{display:"flex",flexDirection:"column"},children:[e(s,{component:m,sx:{my:1},name:"name",type:"text",label:"name"}),i(g,{children:[e(V,{children:"activate facility"}),e(s,{component:A,type:"checkbox",name:"activate"})]}),e(s,{component:m,type:"text",label:"address",name:"address",sx:{my:1}}),e(s,{component:m,type:"text",label:"razor pay merchant id",name:"razorpay_id",sx:{my:1}}),e(s,{component:m,type:"email",label:"email",name:"email",sx:{my:1}}),e(N,{label:"phone",variant:"outlined",countryCodeEditable:!1,sx:{my:1},defaultCountry:"in",onChange:p=>d("phone",p.toString())}),r&&e(E,{})]})})}),i(z,{children:[e(f,{onClick:c,children:"Cancel"}),e(f,{onClick:()=>{t().then(()=>null)},children:"Add"})]})]})})]})]})},X=[{field:"name",headerName:"name",width:300,editable:!1,sortable:!0},{field:"email",headerName:"e-mail id",sortable:!1,width:400},{field:"phone",headerName:"phone",sortable:!1,width:150},{field:"activate",headerName:"active",sortable:!1,width:150,valueGetter:n=>n.value?"active":"in-active"},{field:"edit",headerName:"Edit",width:130,sortable:!1,filterable:!1,renderCell:n=>e(J,{id:n.row.id})}],re=()=>{var C;const[n,h]=b.exports.useState(""),[u,c]=b.exports.useState(1),[a,x]=b.exports.useState([]),[t,r]=b.exports.useState(1),{data:d,loading:p}=W({variables:{orderBy:a,where:{_or:[{name:{_like:`%${n}%`}},{email:{_like:`%${n}%`}}]},offset:(u-1)*t,limit:t}}),{data:y,loading:k}=I({variables:{orderBy:a,where:{_or:[{name:{_like:`%${n}%`}},{email:{_like:`%${n}%`}}]}}});return i(g,{children:[e(U,{}),e(Q,{fullWidth:!0,onChange:l=>{h(l.target.value)},sx:{width:"100%",my:2},name:"search",label:"Search"}),e(g,{height:500,width:"100%",textAlign:"center",children:e(K,{data:(d==null?void 0:d.tenents)||[],pageSize:t,setPageSize:r,setFilter:()=>null,setPage:c,setSort:x,loading:p||k,rowCount:((C=y==null?void 0:y.tenents_aggregate.aggregate)==null?void 0:C.count)||0,columns:X})})]})};export{re as default};

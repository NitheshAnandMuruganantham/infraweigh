(self.webpackChunk=self.webpackChunk||[]).push([[462],{66462:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>Qe});var n=i(2784),a=i(14030),l=i.n(a),r=i(96039),s=i.n(r),o=i(10261),d=i.n(o),c=i(96292),u=i.n(c),m=i(77902),h=i.n(m),x=i(26515),g=i.n(x),p=i(63497),v=i.n(p),b={};b.styleTagTransform=g(),b.setAttributes=u(),b.insert=d().bind(null,"head"),b.domAPI=s(),b.insertStyleElement=h();l()(v(),b);v()&&v().locals&&v().locals;var j=i(32806),f=i(28865),y=i(1826),_=i(44101),w=i(7512),Z=i(48266),k=i(44324),C=i(29438),S=i(62455),N=i(68013),I=i(14606),F=i(57651),P=i(18236),q=i(40234),W=i.n(q),B=i(35594),R=i(52322);const O=n.forwardRef((function(e,t){return(0,R.jsx)(N.Z,Object.assign({direction:"up",ref:t},e))})),D=({name:e,id:t})=>{var i;const[a,l]=n.useState(!1),r=()=>{l(!1)},[s,o]=n.useState(null),[d]=(0,_.W7)({variables:{billByPkId:t}}),c=n.useRef(),[u,m]=n.useState(!1);return(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(B.Z,{open:u,setOpen:()=>null},""),(0,R.jsx)(w.ZP,{onClick:async()=>{var e,t,i,n,a,r,s,c;m(!0);let u=await d();const h=await(0,F.Jt)((0,F.iH)(P.tO,null==(e=u.data)||null==(t=e.bill_by_pk)?void 0:t.photos[0])),x=await(0,F.Jt)((0,F.iH)(P.tO,null==(i=u.data)||null==(n=i.bill_by_pk)?void 0:n.photos[1])),g=await(0,F.Jt)((0,F.iH)(P.tO,null==(a=u.data)||null==(r=a.bill_by_pk)?void 0:r.photos[2])),p=await(0,F.Jt)((0,F.iH)(P.tO,null==(s=u.data)||null==(c=s.bill_by_pk)?void 0:c.photos[3]));u&&u.data&&u.data.bill_by_pk&&u.data.bill_by_pk.photos&&(u.data.bill_by_pk.photos=[h,x,g,p]),o(u),m(!1),l(!0)},variant:"outlined",size:"small",children:e}),(0,R.jsxs)(Z.ZP,{open:a,TransitionComponent:O,keepMounted:!0,fullWidth:!0,maxWidth:"md",onClose:r,"aria-describedby":"alert-dialog-slide-description",children:[(0,R.jsx)(S.ZP,{}),(0,R.jsx)(C.ZP,{children:(0,R.jsx)("span",{ref:c,children:null!==s&&s?(0,R.jsx)(I.n,{data:null==(i=s.data)?void 0:i.bill_by_pk}):(0,R.jsx)(y.D8x,{})})}),(0,R.jsxs)(k.ZP,{children:[(0,R.jsx)(w.ZP,{onClick:r,children:"close"}),(0,R.jsx)(W(),{content:()=>c.current,trigger:()=>(0,R.jsx)(w.ZP,{children:"print"})})]})]})]})};var Q=i(19055),G=i(83703),V=i(35761),z=i(59104),A=i(31689);const M=[{field:"vehicle_number",headerName:"vehicle number",width:150,editable:!1},{field:"material",headerName:"material",width:100,valueGetter:e=>e.value.name},{field:"customer",headerName:"customer",width:150,valueGetter:e=>e.value&&e.value.name?e.value.name:"null"},{field:"customer_2",headerName:"customer 2",width:150,valueGetter:e=>e.value&&e.value.name?e.value.name:"null"},{field:"customer_3",headerName:"customer 3",width:150,valueGetter:e=>e.value&&e.value.name?e.value.name:"null"},{field:"vehicle",headerName:"vehicle",sortable:!0,width:150,valueGetter:e=>e.value.name},{field:"created_at",headerName:"created At",sortable:!0,width:250,valueGetter:e=>e.value&&new Date(e.value).toLocaleString("en-US",{weekday:"long",year:"numeric",month:"long",hour12:!0,hour:"numeric",minute:"numeric",second:"numeric",day:"numeric"})||""},{field:"second_weight",headerName:"second weight",sortable:!0,width:110,valueGetter:e=>e.value?"scale weight":"tare weight"},{field:"scale_weight",headerName:"scaleWeight",sortable:!0,width:120},{field:"tare_weight",headerName:"tareWeight",sortable:!0,width:120},{field:"netWeight",headerName:"netWeight",sortable:!0,width:120,valueGetter:e=>Math.abs(parseInt(e.row.scale_weight,10)-parseInt(e.row.tare_weight||"0",10)||0)},{field:"info",headerName:"info",sortable:!1,width:120,renderCell:e=>(0,R.jsx)(D,{name:"info",id:e.row.id})}],U=()=>{var e;const[t,i]=n.useState(10),[a,l]=n.useState(1),[r,s]=n.useState([]),[o,d]=n.useState({}),[c,u]=n.useState(!1),{data:m,loading:h}=(0,_.Np)({variables:{orderBy:o,where:{_and:[{tenent_id:{_eq:localStorage.getItem("x-tenent-id")}},{weighbridge_id:{_eq:localStorage.getItem("x-weighbridge-id")}},...r]},offset:(a-1)*t<0?0:(a-1)*t,limit:t}}),{data:x,loading:g}=(0,_.nG)({variables:{where:{_and:[{tenent_id:{_eq:localStorage.getItem("x-tenent-id")}},{weighbridge_id:{_eq:localStorage.getItem("x-weighbridge-id")}},...r]}}}),{data:p,loading:v}=(0,_.EM)({variables:{where:{_and:[{tenent_id:{_eq:localStorage.getItem("x-tenent-id")}}]}}}),{data:b,loading:j}=(0,_.h7)(),{data:w,loading:Z}=(0,_.xE)(),k=n.useRef(null);return n.useEffect((()=>{var e,t;c||(null==(e=k.current)||e.setFieldValue("from","",!1),null==(t=k.current)||t.setFieldValue("to","",!1))}),[c]),(0,R.jsx)(y.xuv,{children:(0,R.jsxs)(y.xuv,{height:600,width:"100%",textAlign:"center",children:[(0,R.jsx)(y.ukE,{sx:{visibility:g||v||Z||j||h||g?"visible":"hidden"}}),(0,R.jsx)(Q.J9,{innerRef:k,onSubmit:(e,{setSubmitting:t})=>{let i=[];e.vehicle_number&&e.vehicle_number.length>0&&(i=[...i,{vehicle_number:{_like:`%${e.vehicle_number}%`}}]),e.vehicle.value&&e.vehicle.value.length>0&&(i=[...i,{vehicle_id:{_eq:e.vehicle.value}}]),e.customer.value&&e.customer.value.length>0&&(i=[...i,{_or:[{customer_id:{_eq:e.customer.value}},{customer_2_id:{_eq:e.customer.value}},{customer_3_id:{_eq:e.customer.value}}]}]),e.from&&e.from.length>0&&e.to&&e.to.length>0&&(i=[...i,{created_at:{_gte:new Date(e.from).toISOString(),_lte:new Date(e.to).toISOString()}}]),e.material.value&&e.material.value.length>0&&(i=[...i,{material_id:{_eq:e.material.value}}]),s(i),t(!1)},initialValues:{vehicle_number:"",material:{label:"",value:""},vehicle:{label:"",value:""},customer:{label:"",value:""},from:"",to:""},children:({handleSubmit:e,setFieldValue:t,values:i})=>(0,R.jsxs)("form",{onSubmit:e,children:[(0,R.jsxs)(y.xuv,{display:"flex",flexDirection:"row",children:[(0,R.jsx)(Q.gN,{component:G.nv,name:"vehicle_number",onChange:e=>t("vehicle_number",e.target.value.replace(" ","").toUpperCase()),label:"vehicle number",sx:{margin:2,width:"40%"}}),(0,R.jsx)(Q.gN,{component:G.F2,name:"material",options:(null==b?void 0:b.material)||[],renderInput:e=>(0,R.jsx)(y.nvn,Object.assign({},e,{label:"Material"})),id:"outlined-required",sx:{margin:2,width:"40%"}}),(0,R.jsx)(Q.gN,{component:G.F2,name:"customer",options:(null==p?void 0:p.customer)||[],renderInput:e=>(0,R.jsx)(y.nvn,Object.assign({},e,{label:"Customer"})),id:"outlined-required",sx:{margin:2,width:"40%"}}),(0,R.jsx)(Q.gN,{component:G.F2,name:"vehicle",options:(null==w?void 0:w.vehicle)||[],renderInput:e=>(0,R.jsx)(y.nvn,Object.assign({},e,{label:"vehicle"})),id:"outlined-required",sx:{margin:2,width:"40%"}})]}),(0,R.jsxs)(y.xuv,{display:"flex",alignItems:"flex-start",sx:{ml:1},children:[(0,R.jsx)(y.XZJ,{onChange:e=>u(e.target.checked)}),(0,R.jsx)(y.ZT$,{variant:"body2",sx:{ml:1,my:"auto"},children:"filter by time"})]}),c&&(0,R.jsxs)(y.xuv,{display:"flex",gap:"10px",sx:{mt:2,ml:2},flexDirection:"row",children:[(0,R.jsx)(z._,{dateAdapter:V.H,children:(0,R.jsx)(A.x,{renderInput:e=>(0,R.jsx)(y.nvn,Object.assign({},e)),disableFuture:!0,label:"from date",value:new Date(i.from),onChange:e=>{t("from",(null==e?void 0:e.toISOString())||"")}})}),(0,R.jsx)(z._,{dateAdapter:V.H,children:(0,R.jsx)(A.x,{renderInput:e=>(0,R.jsx)(y.nvn,Object.assign({},e)),label:"to date",minDateTime:new Date(i.from),disableFuture:!0,value:i.to,onChange:e=>{t("to",(null==e?void 0:e.toISOString())||"")}})})]}),(0,R.jsxs)(y.xuv,{display:"flex",m:1,alignItems:"flex-start",children:[(0,R.jsx)(y.zxk,{type:"submit",children:"submit"}),(0,R.jsx)(y.zxk,{type:"reset",children:"reset"})]})]})}),g||v||Z||j?null:(0,R.jsx)(f._$r,{loading:h||g,onPageChange:e=>l(e),disableColumnFilter:!0,disableColumnMenu:!0,onPageSizeChange:e=>i(e),disableColumnSelector:!0,rows:(null==m?void 0:m.bill)||[],paginationMode:"server",rowCount:null==x||null==(e=x.bill_aggregate.aggregate)?void 0:e.count,columns:M,autoPageSize:!0,filterMode:"server",onFilterModelChange:e=>s(e),onSortModelChange:e=>d(e),disableSelectionOnClick:!0})]})})},E=n.forwardRef((function(e,t){return(0,R.jsx)(N.Z,Object.assign({direction:"up",ref:t},e))})),J=({open:e,setOpen:t,data:i})=>{const a=async()=>{t(!1)},l=n.useRef();return(0,R.jsxs)(Z.ZP,{sx:{zIndex:"10000"},open:e,TransitionComponent:E,keepMounted:!0,fullWidth:!0,maxWidth:"md",onClose:a,"aria-describedby":"alert-dialog-slide-description",children:[(0,R.jsx)(S.ZP,{}),(0,R.jsx)(C.ZP,{children:e?(0,R.jsx)("span",{ref:l,children:(0,R.jsx)(I.n,{data:i})}):null}),(0,R.jsxs)(k.ZP,{children:[(0,R.jsx)(w.ZP,{onClick:a,children:"close"}),(0,R.jsx)(W(),{content:()=>l.current,trigger:()=>(0,R.jsx)(w.ZP,{children:"print"})})]})]})};var X=i(65413),L=i(6389);const H=({vehicleNumber:e,setWeight:t,setBillRefId:i})=>{const[a,l]=n.useState([]),[r,s]=n.useState(!1),[o]=(0,_.Yq)(),d=()=>{s(!1)},c=[{field:"id",width:300,headerName:"id",editable:!1},{field:"scale_weight",headerName:"weight",width:300,editable:!1},{field:"created_at",headerName:"created at",width:400,valueGetter:e=>new Date(e.value).toLocaleString(),editable:!1},{field:"select",headerName:"select",renderCell:e=>(0,R.jsx)(w.ZP,{onClick:()=>{t(e.row.scale_weight||0),i(e.row.id),d()},variant:"outlined",size:"small",children:"select"})}];return(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(w.ZP,{variant:"outlined",sx:{m:1,width:"60%"},onClick:async()=>{await o({variables:{where:{vehicle_number:{_eq:e}},limit:50}}).then((e=>{var t;null==(t=e.data)||t.bill.map((e=>{l([...a,{id:e.id,created_at:e.created_at,scale_weight:e.scale_weight}])}))})),s(!0)},children:"select weight"}),(0,R.jsxs)(Z.ZP,{maxWidth:"xl",fullWidth:!0,open:r,onClose:d,children:[(0,R.jsx)(S.ZP,{children:"select weight"}),(0,R.jsx)(C.ZP,{children:(0,R.jsx)(L.xu,{height:"500px",children:(0,R.jsx)(f._$r,{rows:a,columns:c})})}),(0,R.jsx)(k.ZP,{children:(0,R.jsx)(w.ZP,{onClick:d,children:"Cancel"})})]})]})};var $=i(39304),Y=i(28709),T=i.n(Y);const K=n.forwardRef((function(e,t){return(0,R.jsx)(N.Z,Object.assign({direction:"up",ref:t},e))})),ee=({setData1:e,setData2:t,setData3:i,setData4:a,submitting:l})=>{const[r,s]=n.useState(!1),o=()=>{s(!1)},[d,c]=n.useState([]),[u,m]=n.useState([]);let h=n.useRef([]);h.current=[0,0,0,0].map(((e,t)=>h.current[t]=n.createRef()));return(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(w.ZP,{disabled:l,sx:{margin:2,width:"90%"},onClick:async()=>{await navigator.mediaDevices.getUserMedia({video:!0}).then((async e=>{await navigator.mediaDevices.enumerateDevices().then((e=>{if(e.length<4)alert("at least 4 cameras are required");else{const t=e.filter((e=>"videoinput"===e.kind));console.log(t),c(t),s(!0)}}))}))},variant:"outlined",size:"small",children:"capture"}),(0,R.jsxs)(Z.ZP,{open:r,TransitionComponent:K,keepMounted:!0,fullWidth:!0,maxWidth:"xl",onClose:o,children:[(0,R.jsx)(y.$N8,{children:"select any four images"}),(0,R.jsx)(C.ZP,{children:d.length>0&&d.map(((e,t)=>(0,R.jsx)(T(),{audio:!1,onClick:()=>{u.includes(t)?m(u.filter((e=>e!==t))):!(u.length>=4)&&m([...u,t])},style:{border:u.includes(t)?"4px solid red":"",padding:"10px",margin:"3px"},videoConstraints:{aspectRatio:1,deviceId:{exact:e.deviceId}},height:340,ref:h.current[t],screenshotFormat:"image/jpeg",width:340},e.deviceId)))}),(0,R.jsxs)(k.ZP,{children:[(0,R.jsx)(w.ZP,{onClick:o,children:"close"}),(0,R.jsx)(w.ZP,{style:{display:u.length>=4?"flex":"none"},onClick:async()=>{await Promise.all(u.map((e=>h.current[e].current.getScreenshot()))).then((n=>{e(n[0]),t(n[1]),i(n[2]),a(n[3]),m([]),o()}))},variant:"contained",color:"primary",children:"submit"})]})]})]})};var te=i(90047);const ie=()=>{const{data:e,loading:t}=(0,_.EM)({variables:{where:{tenent_id:{_eq:localStorage.getItem("x-tenent-id")}}}}),{data:i,loading:a}=(0,_.h7)(),{data:l,loading:r}=(0,_.xE)(),[s]=(0,_.sy)(),[o,d]=(0,n.useState)(),[c,u]=(0,n.useState)(!1),[m,h]=(0,n.useState)(null),[x,g]=(0,n.useState)(null),[p,v]=(0,n.useState)(null),[b,j]=(0,n.useState)(null),[f,w]=(0,n.useState)(null),[Z,k]=(0,n.useState)(!0);return(0,n.useEffect)((()=>{i&&e&&l&&k(!1)}),[a,t,r,i,e,l]),(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(B.Z,{open:Z,setOpen:k}),(0,R.jsx)(Q.J9,{initialValues:{vehicleNumber:"",material:{label:"",value:""},vehicle:{label:"",value:""},buyer:{label:"",value:null},seller:{label:"",value:null},trader:{label:"",value:null},secondWeight:!1,charges:0,scaleWeight:0,tareWeight:0,paidBy:"other"},validationSchema:()=>X.Ry().shape({vehicleNumber:X.Z_().required("Required"),material:X.Ry().shape({value:X.Z_().required("Required"),label:X.Z_().required("Required")}).required(),vehicle:X.Ry().shape({value:X.Z_().required("Required"),label:X.Z_().required("Required")}).required(),charges:X.Rx().required(),scaleWeight:X.Z_().required("Required"),tareWeight:X.Vo((e=>e.secondWeight?X.Z_().required("Required"):X.Z_())),buyer:X.Ry().shape({value:X.Z_().required("Required"),label:X.Z_().required("Required")})}),onSubmit:async(e,{setSubmitting:t,resetForm:i})=>{t(!0),k(!0);try{var n;const a=(0,$.v4)();let l=Object.assign({},e);e.secondWeight||(l.tareWeight=null);const r=await(null==(n=P.I8.currentUser)?void 0:n.getIdTokenResult()),d=null==r?void 0:r.claims["https://hasura.io/jwt/claims"],c=`${d["x-hasura-tenent-id"]}/${d["x-hasura-weighbridge-id"]}/${a}-folder/one.jpeg`,m=`${d["x-hasura-tenent-id"]}/${d["x-hasura-weighbridge-id"]}/${a}-folder/two.jpeg`,y=`${d["x-hasura-tenent-id"]}/${d["x-hasura-weighbridge-id"]}/${a}-folder/three.jpeg`,_=`${d["x-hasura-tenent-id"]}/${d["x-hasura-weighbridge-id"]}/${a}-folder/four.jpeg`,Z=await(0,F.sf)((0,F.iH)(P.tO,c),x,"data_url"),C=await(0,F.sf)((0,F.iH)(P.tO,m),p,"data_url"),S=await(0,F.sf)((0,F.iH)(P.tO,y),b,"data_url"),N=await(0,F.sf)((0,F.iH)(P.tO,_),f,"data_url");await s({variables:{object:{id:a,photos:[Z.ref.fullPath,C.ref.fullPath,S.ref.fullPath,N.ref.fullPath],charges:e.charges,vehicle_id:e.vehicle.value,material_id:e.material.value,vehicle_number:e.vehicleNumber,customer_id:e.buyer.value,customer_2_id:e.seller.value,customer_3_id:e.trader.value,scale_weight:e.scaleWeight,tare_weight:e.secondWeight?e.tareWeight:0,second_weight:e.secondWeight,reference_bill_id:e.secondWeight?o:null,paid_by:e.paidBy}}}).catch((()=>{(0,F.oq)(Z.ref),(0,F.oq)(C.ref),(0,F.oq)(S.ref),(0,F.oq)(N.ref)})).then((e=>{var n;let a=null==e||null==(n=e.data)?void 0:n.insert_bill_one;a.photos=[x,p,b,f],h(a),u(!0),g(null),v(null),j(null),w(null),t(!1),te.Am.success("Bill Added Successfully"),i(),k(!1)}))}catch(a){k(!1),t(!1),console.log(a)}},children:({submitForm:t,isSubmitting:n,setFieldValue:a,values:r,isValid:s,resetForm:o})=>(0,R.jsxs)(y.xuv,{component:"form",sx:{display:"flex",flexDirection:"row"},noValidate:!0,autoComplete:"off",children:[(0,R.jsxs)(y.xuv,{sx:{flexDirection:"column",width:"50%",display:"flex",height:"100%"},children:[(0,R.jsx)(Q.gN,{component:G.nv,autoFocus:!0,name:"vehicleNumber",onChange:e=>a("vehicleNumber",e.target.value.replace(" ","").toUpperCase()),label:"vehicle number",sx:{margin:2,width:"90%"}}),(0,R.jsx)(ee,{submitting:n,setData1:g,setData2:v,setData3:j,setData4:w}),(0,R.jsxs)(y.xuv,{flex:1,flexDirection:"column",children:[x&&(0,R.jsx)("img",{style:{margin:"10px",width:"100px"},src:x,alt:"photo1"}),p&&(0,R.jsx)("img",{style:{margin:"10px",width:"100px"},src:p,alt:"photo1"}),b&&(0,R.jsx)("img",{style:{margin:"10px",width:"100px"},src:b,alt:"photo1"}),f&&(0,R.jsx)("img",{style:{margin:"10px",width:"100px"},src:f,alt:"photo1"})]}),(0,R.jsx)(Q.gN,{component:G.F2,name:"material",options:(null==i?void 0:i.material)||[],renderInput:e=>(0,R.jsx)(y.nvn,Object.assign({},e,{label:"Material"})),id:"outlined-required",sx:{margin:2,width:"90%"}}),(0,R.jsx)(Q.gN,{component:G.F2,filterOptions:(e,t)=>e.filter((e=>e.value!==r.trader.value&&e.value!==r.seller.value)),name:"buyer",filter:!0,options:(null==e?void 0:e.customer)||[],renderInput:e=>(0,R.jsx)(y.nvn,Object.assign({},e,{label:"buyer"})),sx:{margin:2,width:"90%"}}),(0,R.jsx)(Q.gN,{name:"seller",filterOptions:(e,t)=>e.filter((e=>e.value!==r.trader.value&&e.value!==r.buyer.value)),component:G.F2,options:(null==e?void 0:e.customer)||[],renderInput:e=>(0,R.jsx)(y.nvn,Object.assign({},e,{label:"seller"})),id:"outlined-required",sx:{margin:2,width:"90%"}}),(0,R.jsx)(Q.gN,{name:"trader",filterOptions:(e,t)=>e.filter((e=>e.value!==r.buyer.value&&e.value!==r.seller.value)),component:G.F2,options:(null==e?void 0:e.customer)||[],renderInput:e=>(0,R.jsx)(y.nvn,Object.assign({},e,{label:"trader or mediator"})),sx:{margin:2,width:"90%"}}),(0,R.jsxs)(y.xuv,{children:[(0,R.jsx)(y.lXp,{children:"second weight or tare weight"}),(0,R.jsx)(Q.gN,{component:G.rs,type:"checkbox",name:"secondWeight"})]}),(0,R.jsxs)(y.xuv,{sx:{margin:2,width:"90%"},children:[(0,R.jsx)(y.lXp,{children:"paid by"}),(0,R.jsxs)(Q.gN,{component:G.Ee,row:!0,name:"paidBy",children:[(0,R.jsx)(y.D8G,{value:"buyer",control:(0,R.jsx)(y.Y8K,{}),label:"buyer"}),(0,R.jsx)(y.D8G,{value:"trader",control:(0,R.jsx)(y.Y8K,{}),label:"trader"}),(0,R.jsx)(y.D8G,{value:"seller",control:(0,R.jsx)(y.Y8K,{}),label:"seller"}),(0,R.jsx)(y.D8G,{value:"driver",control:(0,R.jsx)(y.Y8K,{}),label:"driver"}),(0,R.jsx)(y.D8G,{value:"other",control:(0,R.jsx)(y.Y8K,{}),label:"other"})]})]})]}),(0,R.jsxs)(y.xuv,{sx:{width:"50%",height:"100%",display:"flex",flexDirection:"column"},children:[(0,R.jsx)(Q.gN,{component:G.nv,name:"scaleWeight",label:"scale weight",sx:{m:2,width:"90%"},InputProps:{endAdornment:(0,R.jsx)(y.oGm,{position:"start",children:"kg"})}}),r.secondWeight&&(0,R.jsxs)(y.xuv,{sx:{m:1,width:"90%",display:"flex"},children:[(0,R.jsx)(H,{setWeight:e=>{a("tareWeight",e)},setBillRefId:e=>{d(e)},vehicleNumber:r.vehicleNumber}),(0,R.jsx)(Q.gN,{component:G.nv,label:"Tare weight",InputProps:{endAdornment:(0,R.jsx)(y.oGm,{position:"start",children:"kg"})},name:"tareWeight",sx:{m:1,width:"50%"}})]}),(0,R.jsx)(Q.gN,{component:G.F2,name:"vehicle",options:(null==l?void 0:l.vehicle)||[],renderInput:e=>(0,R.jsx)(y.nvn,Object.assign({},e,{label:"Vehicle"})),id:"outlined-required",sx:{margin:2,width:"90%"}}),(0,R.jsx)(Q.gN,{component:G.nv,name:"charges",type:"number",sx:{margin:2,width:"90%"}}),(0,R.jsxs)(y.xuv,{sx:{margin:2,width:"90%",justifyContent:"end",display:"flex"},children:[s&&x&&p&&b&&b&&(0,R.jsx)(y.zxk,{sx:{marginRight:2},onClick:()=>t(),variant:"contained",color:"success",children:"ACCEPT"}),(0,R.jsx)(y.zxk,{variant:"contained",onClick:()=>o(),color:"error",children:"RESET"})]})]})]})}),(0,R.jsx)(J,{data:m,open:c,setOpen:u})]})};var ne=i(69740),ae=i(27591),le=i(73786),re=i(95995),se=i(74760),oe=i(18281),de=i(20268),ce=i(43663),ue=i(5919),me=i(34766),he=i(42603),xe=i(49001),ge=i(28319),pe=i(22082),ve=i(42981),be=i(8664),je=i(90288),fe=i(30808),ye=i(96610),_e=i(12695);const we=240,Ze=e=>({width:we,transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen}),overflowX:"hidden"}),ke=e=>({transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),overflowX:"hidden",width:`calc(${e.spacing(7)} + 1px)`,[e.breakpoints.up("sm")]:{width:`calc(${e.spacing(8)} + 1px)`}}),Ce=(0,ne.zo)("div")((({theme:e})=>Object.assign({display:"flex",alignItems:"center",justifyContent:"flex-end",padding:e.spacing(0,1)},e.mixins.toolbar))),Se=(0,ne.zo)(re.ZP,{shouldForwardProp:e=>"open"!==e})((({theme:e,open:t})=>Object.assign({zIndex:e.zIndex.drawer+1,transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},t&&{marginLeft:we,width:"calc(100% - 240px)",transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})}))),Ne=(0,ne.zo)(le.ZP,{shouldForwardProp:e=>"open"!==e})((({theme:e,open:t})=>Object.assign({width:we,flexShrink:0,whiteSpace:"nowrap",boxSizing:"border-box"},t&&Object.assign({},Ze(e),{"& .MuiDrawer-paper":Ze(e)}),!t&&Object.assign({},ke(e),{"& .MuiDrawer-paper":ke(e)})))),Ie=({children:e})=>{var t,i;const[a,l]=(0,n.useState)(null),r=(0,j.s0)(),s=(0,ne.Fg)(),[o,d]=n.useState(!1),c=[{name:"Home",path:"/",icon:fe.SK8,active:(0,j.bS)("/")},{name:"report",path:"/report",icon:_e.Z,active:(0,j.bS)("/report")},{name:"clients",path:"/clients",icon:je.Z,active:(0,j.bS)("/clients")}];return(0,R.jsxs)(ae.Z,{sx:{display:"flex"},children:[(0,R.jsx)(de.Z,{}),(0,R.jsx)(Se,{position:"fixed",open:o,children:(0,R.jsxs)(se.ZP,{children:[(0,R.jsx)(me.default,{color:"inherit","aria-label":"open drawer",onClick:async()=>{await void d(!0);const e=(0,ye.V1)(P.wk,"callFunc");await e()},edge:"start",sx:Object.assign({marginRight:5},o&&{display:"none"}),children:(0,R.jsx)(he.Z,{})}),(0,R.jsx)(ce.ZP,{variant:"h6",noWrap:!0,component:"div",children:"INFRA WEIGH"}),(0,R.jsxs)(ae.Z,{sx:{marginLeft:"auto",flexGrow:0},children:[(0,R.jsx)(y.v2r,{sx:{mt:"45px"},anchorEl:a,anchorOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:Boolean(a),onClose:()=>{l(null)},children:(0,R.jsx)(y.sNh,{onClick:()=>{(0,te.Am)("Logging out...",{}),setTimeout((()=>{P.I8.signOut(),window.location.reload()}),1e3)},children:(0,R.jsx)(ce.ZP,{textAlign:"center",children:"log out"})},"logOut")}),(0,R.jsx)(y.ua7,{title:(null==(t=P.I8.currentUser)?void 0:t.displayName)+"",children:(0,R.jsx)(me.default,{onClick:e=>{l(e.currentTarget)},sx:{p:0},children:(0,R.jsx)(y.qEK,{src:(null==P.I8||null==(i=P.I8.currentUser)?void 0:i.photoURL)+""})})})]})]})}),(0,R.jsxs)(Ne,{variant:"permanent",open:o,children:[(0,R.jsx)(Ce,{children:(0,R.jsx)(me.default,{onClick:()=>{d(!1)},children:"rtl"===s.direction?(0,R.jsx)(ge.Z,{}):(0,R.jsx)(xe.Z,{})})}),(0,R.jsx)(ue.default,{}),(0,R.jsx)(oe.ZP,{children:c.map(((e,t)=>(0,R.jsxs)(pe.ZP,{onClick:()=>r(e.path),sx:{":hover":{backgroundColor:e.active?"slategray":"whitesmoke"},backgroundColor:e.active?"gray":"inherit",backgroundOpacity:50,margin:1,borderRadius:"5px",minHeight:48,justifyContent:o?"initial":"center",px:2.5},children:[(0,R.jsx)(ve.ZP,{sx:{minWidth:0,mr:o?3:"auto",justifyContent:"center"},children:(0,R.jsx)(e.icon,{htmlColor:e.active?"white":"gray"})}),(0,R.jsx)(be.ZP,{primary:e.name,sx:{color:e.active?"white":"inherit",opacity:o?1:0}})]},t)))})]}),(0,R.jsx)(ae.Z,{component:"main",sx:{flexGrow:1,p:3,mt:7},children:e})]})};var Fe=i(47622),Pe=i.n(Fe);const qe=()=>{const[e,t]=n.useState(!1),i=()=>{t(!1)},[a,{loading:l}]=(0,_.Nv)();return(0,R.jsxs)("div",{children:[(0,R.jsx)(B.Z,{open:l,setOpen:()=>null}),(0,R.jsx)(w.ZP,{variant:"outlined",sx:{m:1},onClick:()=>{t(!0)},children:"new client"}),(0,R.jsxs)(Z.ZP,{fullWidth:!0,open:e,onClose:i,children:[(0,R.jsx)(S.ZP,{children:"New Client"}),(0,R.jsx)(Q.J9,{initialValues:{name:null,address:null,email:null,phone:null,gst_in:null,company_name:null,credit:!1,credit_limit:0,branch:{value:null,label:""}},validationSchema:()=>X.Ry().shape({name:X.Z_().required("Required"),address:X.Z_().required("Required"),email:X.Z_().required("Required"),phone:X.Z_().required("Required"),company_name:X.Z_().required("Required"),credit_limit:X.Z_()}),onSubmit:async(e,{setSubmitting:t})=>{t(!0),a({variables:{object:{name:e.name,email:e.email,phone:e.phone,gst_in:e.gst_in,blocked:!1,company_name:e.company_name,company_address:e.address,credit:e.credit,credit_limit:e.credit_limit}}}).catch((()=>{te.Am.error("can not create new client")})).then((()=>{te.Am.success("client created successfully")})),t(!1),i()},children:({submitForm:e,isSubmitting:t,setFieldValue:n})=>(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(C.ZP,{children:(0,R.jsx)(Q.l0,{children:(0,R.jsxs)(L.xu,{sx:{display:"flex",flexDirection:"column"},children:[(0,R.jsx)(Q.gN,{component:G.nv,sx:{my:1},name:"name",type:"text",label:"name"}),(0,R.jsx)(Q.gN,{component:G.nv,sx:{my:1},name:"company_name",type:"text",label:"company name"}),(0,R.jsx)(Q.gN,{component:G.nv,sx:{my:1},name:"gst_in",type:"text",label:"gst number"}),(0,R.jsxs)(L.xu,{children:[(0,R.jsx)(y.lXp,{children:"credit facility"}),(0,R.jsx)(Q.gN,{component:G.rs,type:"checkbox",name:"credit"})]}),(0,R.jsx)(Q.gN,{component:G.nv,type:"text",label:"credit limit",name:"credit_limit",sx:{my:1}}),(0,R.jsx)(Q.gN,{component:G.nv,type:"text",label:"address",name:"address",sx:{my:1}}),(0,R.jsx)(Q.gN,{component:G.nv,type:"email",label:"email",name:"email",sx:{my:1}}),(0,R.jsx)(Pe(),{label:"phone",variant:"outlined",countryCodeEditable:!1,sx:{my:1},defaultCountry:"in",onChange:e=>n("phone",e.toString())}),t&&(0,R.jsx)(y.ukE,{})]})})}),(0,R.jsxs)(k.ZP,{children:[(0,R.jsx)(w.ZP,{onClick:i,children:"Cancel"}),(0,R.jsx)(w.ZP,{onClick:()=>{e()},children:"Add"})]})]})})]})]})};var We=i(5713),Be=(i(51294),i(70868));const Re=({id:e})=>{var t,i,a,l,r,s,o,d;const[c,u]=n.useState(!1),[m,{data:h}]=(0,_.cY)({variables:{customerByPkId:e}}),x=()=>{u(!1)};return(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(w.ZP,{variant:"contained",color:"secondary",size:"small",onClick:async()=>{await m(),u(!0)},children:"Edit"}),(0,R.jsxs)(Z.ZP,{fullWidth:!0,open:c,onClose:x,children:[(0,R.jsx)(S.ZP,{children:"Edit user"}),(0,R.jsx)(Q.J9,{initialValues:{name:null==h||null==(t=h.customer_by_pk)?void 0:t.name,address:null==h||null==(i=h.customer_by_pk)?void 0:i.company_address,email:null==h||null==(a=h.customer_by_pk)?void 0:a.email,phone:null==h||null==(l=h.customer_by_pk)?void 0:l.phone,gst_in:null==h||null==(r=h.customer_by_pk)?void 0:r.gst_in,company_name:null==h||null==(s=h.customer_by_pk)?void 0:s.company_name,credit:null==h||null==(o=h.customer_by_pk)?void 0:o.credit,credit_limit:null==h||null==(d=h.customer_by_pk)?void 0:d.credit_limit},validationSchema:()=>X.Ry().shape({name:X.Z_().required("Required"),address:X.Z_().required("Required"),email:X.Z_().required("Required"),phone:X.Z_().required("Required"),company_name:X.Z_().required("Required"),credit_limit:X.Z_()}),onSubmit:async(t,{setSubmitting:i})=>{i(!0),await Be.B.mutate({mutation:_.xx,variables:{pkColumns:{id:e},set:{name:t.name,email:t.email,phone:t.phone,gst_in:t.gst_in,blocked:!1,company_name:t.company_name,company_address:t.address,credit:t.credit,credit_limit:t.credit_limit}}}).catch((()=>{te.Am.error("realted resourses exists delete those resource to contine")})),i(!0),te.Am.success("client updated"),x()},children:({submitForm:e,isSubmitting:t,setFieldValue:i,values:n})=>(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(C.ZP,{children:(0,R.jsx)(Q.l0,{children:(0,R.jsxs)(L.xu,{sx:{display:"flex",flexDirection:"column"},children:[(0,R.jsx)(Q.gN,{component:G.nv,sx:{my:1},name:"name",type:"text",label:"name"}),(0,R.jsx)(Q.gN,{component:G.nv,sx:{my:1},name:"company_name",type:"text",label:"company name"}),(0,R.jsx)(Q.gN,{component:G.nv,sx:{my:1},name:"gst_in",type:"text",label:"gst number"}),(0,R.jsxs)(L.xu,{children:[(0,R.jsx)(y.lXp,{children:"credit facility"}),(0,R.jsx)(Q.gN,{component:G.rs,type:"checkbox",name:"credit"})]}),(0,R.jsx)(Q.gN,{component:G.nv,type:"text",label:"credit limit",name:"credit_limit",sx:{my:1}}),(0,R.jsx)(Q.gN,{component:G.nv,type:"text",label:"address",name:"address",sx:{my:1}}),(0,R.jsx)(Q.gN,{component:G.nv,type:"email",label:"email",name:"email",sx:{my:1}}),(0,R.jsx)(Pe(),{label:"phone",variant:"outlined",value:n.phone,countryCodeEditable:!1,sx:{my:1},defaultCountry:"in",onChange:e=>i("phone",e.toString())}),t&&(0,R.jsx)(y.ukE,{})]})})}),(0,R.jsxs)(k.ZP,{children:[(0,R.jsx)(w.ZP,{onClick:x,children:"Cancel"}),(0,R.jsx)(w.ZP,{onClick:()=>{e()},children:"Add"})]})]})})]})]})},Oe=[{field:"name",headerName:"name",width:300,editable:!1,sortable:!0},{field:"company_address",headerName:"Address",sortable:!1,width:400},{field:"phone",headerName:"phone",sortable:!1,width:150},{field:"email",headerName:"e-mail id",sortable:!1,width:150},{field:"edit",headerName:"Edit",width:75,sortable:!1,filterable:!1,renderCell:e=>(0,R.jsx)(Re,{id:e.row.id})},{field:"delete",headerName:"Delete",width:75,sortable:!1,filterable:!1,renderCell:e=>(0,R.jsx)(y.zxk,{variant:"contained",color:"error",size:"small",onClick:()=>{(0,We._1)({title:"Confirm to Delete",message:"Are you sure want to delete this.",buttons:[{label:"Yes",onClick:()=>{Be.B.mutate({mutation:_.QX,variables:{deleteCustomerByPkId:e.row.id}})}},{label:"No",onClick:()=>null}]})},children:"Delete"})}],De=()=>{var e;const[t,i]=n.useState(""),[a,l]=n.useState(1),[r,s]=n.useState(1),{data:o,loading:d}=(0,_.bL)({variables:{where:{_and:[{name:{_like:`%${t}%`}},{tenent_id:{_eq:localStorage.getItem("x-tenent-id")}}]},offset:(a-1)*r<0?0:(a-1)*r,limit:r}}),{data:c,loading:u}=(0,_.aP)({variables:{where:{_and:[{name:{_like:`%${t}%`}},{tenent_id:{_eq:localStorage.getItem("x-tenent-id")}}]}}});return(0,R.jsxs)(L.xu,{children:[(0,R.jsx)(qe,{}),(0,R.jsx)(y.nvn,{fullWidth:!0,onChange:e=>{i(e.target.value)},sx:{width:"90%",my:2},name:"search",label:"Search"}),(0,R.jsxs)(L.xu,{height:500,width:"100%",textAlign:"center",children:[(0,R.jsx)(y.ukE,{sx:{visibility:u||d?"visible":"hidden"}}),!u&&(0,R.jsx)(f._$r,{loading:d,rows:(null==o?void 0:o.customer)||[],columns:Oe,rowCount:null==c||null==(e=c.customer_aggregate.aggregate)?void 0:e.count,paginationMode:"server",onPageChange:e=>l(e),onPageSizeChange:e=>s(e),autoPageSize:!0,checkboxSelection:!0,disableSelectionOnClick:!0})]})]})},Qe=()=>(0,R.jsx)(Ie,{children:(0,R.jsxs)(j.Z5,{children:[(0,R.jsx)(j.AW,{path:"/",element:(0,R.jsx)(ie,{})}),(0,R.jsx)(j.AW,{path:"/report",element:(0,R.jsx)(U,{})}),(0,R.jsx)(j.AW,{path:"/clients",element:(0,R.jsx)(De,{})})]})})},63497:e=>{e.exports=[[e.id,".App{text-align:center}.App-logo{height:40vmin;pointer-events:none}@media(prefers-reduced-motion: no-preference){.App-logo{animation:App-logo-spin infinite 20s linear}}.App-header{background-color:#282c34;min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:calc(10px + 2vmin);color:#fff}.App-link{color:#61dafb}@keyframes App-logo-spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkFwcC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLEtBQUssaUJBQWlCLENBQUMsVUFBVSxhQUFhLENBQUMsbUJBQW1CLENBQUMsOENBQThDLFVBQVUsMkNBQTJDLENBQUMsQ0FBQyxZQUFZLHdCQUF3QixDQUFDLGdCQUFnQixDQUFDLFlBQVksQ0FBQyxxQkFBcUIsQ0FBQyxrQkFBa0IsQ0FBQyxzQkFBc0IsQ0FBQyw0QkFBNEIsQ0FBQyxVQUFVLENBQUMsVUFBVSxhQUFhLENBQUMseUJBQXlCLEtBQUssc0JBQXNCLENBQUMsR0FBRyx3QkFBd0IsQ0FBQyIsImZpbGUiOiJBcHAuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi5BcHB7dGV4dC1hbGlnbjpjZW50ZXJ9LkFwcC1sb2dve2hlaWdodDo0MHZtaW47cG9pbnRlci1ldmVudHM6bm9uZX1AbWVkaWEocHJlZmVycy1yZWR1Y2VkLW1vdGlvbjogbm8tcHJlZmVyZW5jZSl7LkFwcC1sb2dve2FuaW1hdGlvbjpBcHAtbG9nby1zcGluIGluZmluaXRlIDIwcyBsaW5lYXJ9fS5BcHAtaGVhZGVye2JhY2tncm91bmQtY29sb3I6IzI4MmMzNDttaW4taGVpZ2h0OjEwMHZoO2Rpc3BsYXk6ZmxleDtmbGV4LWRpcmVjdGlvbjpjb2x1bW47YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXI7Zm9udC1zaXplOmNhbGMoMTBweCArIDJ2bWluKTtjb2xvcjojZmZmfS5BcHAtbGlua3tjb2xvcjojNjFkYWZifUBrZXlmcmFtZXMgQXBwLWxvZ28tc3Bpbntmcm9te3RyYW5zZm9ybTpyb3RhdGUoMGRlZyl9dG97dHJhbnNmb3JtOnJvdGF0ZSgzNjBkZWcpfX0iXX0= */","",""]]}}]);